%script{:src => "https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"}
%script{:src => "https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.10/jquery-ui.min.js"}
%script{:src => "http://malsup.com/jquery/block/jquery.blockUI.js"}
%script{:src => "http://maps.googleapis.com/maps/api/js?sensor=false", :type => "text/javascript"}
%script{:src => "/assets/index.js", :type => "text/javascript"}
%script{:src => "/assets/mapfunctions.js", :type => "text/javascript"}
%script{:src => "/assets/YelpLocationService.js", :type => "text/javascript"}
%link{:href => "/assets//master.css", :rel => "stylesheet", :type => "text/css"}
%link{:href => "/assets/reset.css", :media => "all", :rel => "stylesheet", :type => "text/css"}/
%link{:href => "/assets/common.css", :media => "all", :rel => "stylesheet", :type => "text/css"}/
%link{:href => "http://fonts.googleapis.com/css?family=Droid+Sans:700", :rel => "stylesheet", :type => "text/css"}
%link{:HREF => "http://venuespot.net/images/favicon.ico", :REL => "SHORTCUT ICON"}
:css
  .hide { display:none; }
  a {color:#FFF}
  a.btn-2 {background:#febc00 url(/assets/btn-bg.gif) repeat-x left top; border:1px solid #252525; color:#613a02; font-size:24px; font-weight:bold; padding:12px 30px; text-decoration:none; text-shadow:0 1px 0 rgba(255,255,255,.6); -webkit-border-radius:5px; -moz-border-radius:5px; border-radius:5px; display:block}
  .so-ctr {position:absolute; right:0; height:100%; min-height:100%; max-height:100%; width:336px;background:#f1bf25; background:#000; background:rgba(0,0,0,.8)}
  .so-inner {padding:25px}
  .venue-feature {width:198px; float:right}
  .venue-details ul { list-style-type:none; margin:0 0 25px 0; padding:0}
  .venue-details li { padding:8px 0; margin:0}
  .venue-title {font-size:16px; color:#FFF}
  .venue-location {font-size:12px; color:#797979}
  .venue-price {color:#fecf00; font-size:20px; font-weight:bold}
  .spot {background:#202020; padding:10px 15px ; margin-bottom:2px}
  .spot-name {font-size:14px; font-weight:bold; color:#fecf00}
  .categories-bg {background:#161616; padding:15px 25px 25px; border-top:1px solid #494948; border-top:1px solid #363636}
  .bdr-btm {border-bottom:1px dotted #3e3e3e}
  html {
    background: url(/assets/map-bg.png) no-repeat center center fixed;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    background-size: cover;
    -o-background-size: cover;
    margin:0; padding:0;
  }
  td {
    vertical-align:top;
    text-align:right;
  }
  input {
    border: 2px solid #E8E8E8;
    border-radius: 3px 3px 3px 3px;
    color: gray;
    font-family: Trebuchet MS;
    font-size: 17pt;
    margin: 5px;
    padding: 5px;
    vertical-align:top;
  }
  #ad_title{
    height:40px;
    width: 304px;
  }
  #ad_description {
    height: 94px;
    width: 350px;
    vertical-align:top;
    border: 2px solid #E8E8E8;
    border-radius: 3px 3px 3px 3px;
    color: gray;
    font-family: Trebuchet MS;
    font-size: 17pt;
    margin: 5px;
    padding: 5px;
    vertical-align:top;
  }
  #modal {
    width:720px;
    padding: 10px;
    border-radius: 10px;
    background: rgba(64, 64, 64, 0.7);
  }
  .tableContainer{
    background: url(/assets/spacer.png) repeat white;
    border-radius: 5px;
    padding: 10px;
  }
  .postButton {
    background: url(/assets/post-button.png) no-repeat transparent;
    border: none;
    height: 46px;
    width: 120px;
  }
  #ad_image{
    opacity: 0;
    z-index:2;
    width: 318px;
    height: 46px;
  }
  #wrapper {
    width: 318px;
    height: 40;
    position:relative;
  }
  #browse {
    background: url("/assets/browse.png") no-repeat scroll left top transparent;
    display: table-cell;
    font-family: Trebuchet MS;
    font-size: 17pt;
    height: 46px;
    margin-right: 10px;
    padding-left: 10px;
    position: absolute;
    text-align: left;
    top: 5px;
    left: 5px;
    vertical-align: middle;
    width: 318px;
    color: gray;
  }
  #browse span {
    position: absolute;
    top: 5px;
  }

%script{:type => 'text/javascript'}
  :plain
    var successCallback = function(result){
      coords = result.coords;

      lat = coords.latitude.toString().split('.')[0]
      lon = coords.longitude.toString().split('.')[0]

      $("#latitude").val(lat)
      $("#longitude").val(lon)
      $("input:submit").attr("disabled", false)

    }

    var errorCallback = function(){
      alert("Support This!");
    }

    if(geo_position_js.init()){
       geo_position_js.getCurrentPosition(successCallback,errorCallback);
    }else{
      alert("Failed to get your location.");
    }


    $(function() {
      $("form.submit").text("Loading").attr("disable", true)
      $.blockUI({
        message: $('#modal'),
        bindEvents: false,
        css: {
          width: '500',
          background: 'transparent',
          border: 'none'
        },
        overlayCSS: {
          opacity: 0
        },
        focusInput: false
      })
      $("#ad_image").change(function(){
        $("#browse").text($("#ad_image")[0].files[0].name);
      });
      $("#ad_description").data('default', $("#ad_description").val());
      $("#ad_title").data('default', $("#ad_title").val());
      $("#ad_description").focus(function(){
        if($(this).val() == $(this).data('default')){
          $(this).val(''); 
        }
      });
      $("#ad_title").focus(function() { 
        if($(this).val() == $(this).data('default')) {
          $(this).val('');
        }
      });

    });

#googleMap{:style => "z-index:0; height:100%;width:100%;display:none;"}

#modal.hide
  = form_for @ad, :url => "/ad", :method => "post" do |form|
    = form.hidden_field :longitude
    = form.hidden_field :latitude
    %div.tableContainer
      %table
        %tr
          %td
            = form.text_field :title, :value => "Food Name", :tabindex => "-1"
          %td{"rowspan" => "2"}
            %textarea{:name => "ad_description", :id => "ad_description"}
              Add a short description
        %tr
          %td
            #wrapper
              %div#browse
                %span
                  Upload Image
              = form.file_field :image, :tabindex => "1"

        %tr
          %td
          %td
            = submit_tag "", :disabled => "true", :class => "postButton", :tabindex=>"0"
